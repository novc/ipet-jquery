function formmatData(a){var s="",e="",o=new Array,p=new Array,i=new Array,l=new Array,d={},r={};for(var t in a)e!=a[t].subTypeName?(e=a[t].subTypeName,o=[],o.push(a[t]),d={},d.subTypeName=a[t].subTypeName,d.subTypeId=a[t].subTypeId,d.superTypeName=a[t].superTypeName,d.superTypeId=a[t].superTypeId,d.superTypeIcon=a[t].superTypeIcon,d.subTypeList=o,p.push(d)):o.push(a[t]);for(var c in p){var n={},r={};s!=p[c].superTypeName?(s=p[c].superTypeName,i=[],n.subTypeName=p[c].subTypeName,n.subTypeId=p[c].subTypeId,n.goods=p[c].subTypeList,i.push(n),r.superTypeName=p[c].superTypeName,r.superTypeId=p[c].superTypeId,r.superTypeIcon=p[c].superTypeIcon,r.subList=i,l.push(r)):(n.subTypeName=p[c].subTypeName,n.subTypeId=p[c].subTypeId,n.goods=p[c].subTypeList,i.push(n))}return l}function addCart(a){$.ajax({url:"http://localhost:8080/ipet/Addcart",data:{GoodsId:a,GoodsNum:1},success:function(a){"nologin"==a?(alert("您还未登录"),window.location.href="login.html"):Boolean(a)?window.location.href="cart.html":alert("添加失败")}})}$(document).ready(function(){$(".top").load("header.html",function(){topFun()}),$(".footer").load("footer.html"),$.ajax({url:"http://localhost:8080/ipet/getNavTypeName",success:function(a){var s=JSON.parse(a);for(var e in s){var o="<li class='cate_list"+e+"'><h3><span></span><a href='goodsList.html?typeId="+s[e].superTypeId+"'>"+s[e].superTypeName+"<i></i></a></h3></li>";$(".catelist ul").append(o)}}});new Swiper(".swiper-container",{autoplay:5e3,loop:!0,effect:"fade",paginationClickable:!0,pagination:".swiper-pagination"});$.ajax({url:"http://localhost:8080/ipet/getGoodsSpecial",data:{type:0},success:function(a){var s=JSON.parse(a);$(".renew").append("<div class='special-block w-max w mt30'></div>");$(".special-block:last").append("<div class='epetfood-tit ft20'><span>特价商品</span></div>").append("<div class='clearfix'><div class='food-pro'></div></div>");$(".food-pro:last").append("<div class='libconbox'><div class='pro-list'><ul></ul></div></div>");for(var e in s){var o="<li><div class='imgbox'><a href='goodsDetail.html?goodsId="+s[e].goodsId+"'><img class='hoverup' src='img/"+s[e].indexImg+"' /></a></div>",p="<p><a href=''>"+s[e].goodsTitle+"</a></p>",i="<div class='img-foot'><span class='old-price'>"+s[e].price+"</span><span class='price'>"+s[e].nowPrice+"</span>",l="<span class='collect'>❤ <i> "+s[e].collectNum+"</i></span></div>",d="<a class='cart-add' href='javascript:addCart("+s[e].goodsId+")'>加入购物车</a></li>",r=o+p+i+l+d;$(".food-pro:last .libconbox ul").append(r)}}}),$.ajax({url:"http://localhost:8080/ipet/getGoodsSpecial",data:{type:1},success:function(a){var s=JSON.parse(a);$(".renew").append("<div class='special-block w-max w mt30'></div>");$(".special-block:last").append("<div class='epetfood-tit ft20'><span>特别推荐</span></div>").append("<div class='clearfix'><div class='food-pro'></div></div>");$(".food-pro:last").append("<div class='libconbox'><div class='pro-list'><ul></ul></div></div>");for(var e in s){var o="<li><div class='imgbox'><a href='goodsDetail.html?goodsId="+s[e].goodsId+"'><img class='hoverup' src='img/"+s[e].indexImg+"' /></a></div>",p="<p><a href=''>"+s[e].goodsTitle+"</a></p>",i="<div class='img-foot'><span class='old-price'>"+s[e].price+"</span><span class='price'>"+s[e].nowPrice+"</span>",l="<span class='collect'>❤ <i> "+s[e].collectNum+"</i></span></div>",d="<a class='cart-add' href='Javascript:addCart("+s[e].goodsId+")'>加入购物车</a></li>",r=o+p+i+l+d;$(".food-pro:last .libconbox ul").append(r)}}}),$.ajax({url:"http://localhost:8080/ipet/GetIndexGoodsServlet",success:function(a){var s=JSON.parse(a),e=formmatData(s);for(var o in e){var p="<div class='epetfoodblock w-max w mt30' cate="+o+"></div>";$(".renew").append(p);var i="<div class='epetfood-tit ft20'><i class='title-icon'><img src='img/"+e[o].superTypeIcon+"' /></i><span>"+e[o].superTypeName+"</span></div>";$(".epetfoodblock:last").append(i).append("<div class='clearfix'><div class='food-pro'></div></div>");$(".food-pro:last").append("<div class='lib-menu abs'><ul></ul></div><div class='libconbox'><div class='pro-list'><ul></ul></div></div>");var l=e[o].subList;for(var d in l){var r="<li class='active' type='' cate="+l[d].subTypeId+"><p></p><span>"+l[d].subTypeName+"</span></li>",t="<li type='' cate="+l[d].subTypeId+"><p></p><span>"+l[d].subTypeName+"</span></li>";0==d?$(".food-pro:last .lib-menu ul").append(r):$(".food-pro:last .lib-menu ul").append(t)}var c=e[o].subList[0].goods;for(var n in c)if(n<10){var u="<li><div class='imgbox'><a href='goodsDetail.html?goodsId="+c[n].goodsId+"'><img class='hoverup' src='img/"+c[n].indexImg+"' /></a></div><p><a href=''>"+c[n].goodsTitle+"</a></p><span class='price'>"+c[n].nowPrice+"</span></li>";$(".food-pro:last .libconbox ul").append(u)}}$(".lib-menu li").mouseenter(function(){var a=$(this).attr("cate");$(this).parent("ul").children("li").removeClass("active"),$(this).addClass("active");var s=$(this).parents(".food-pro").children(".libconbox").children(".pro-list").children("ul");s.empty();for(var o in e){var p=e[o].subList;for(var i in p){var l=p[i];if(l.subTypeId==a){var d=l.goods;for(var r in d)if(r<10){var t="<li><div class='imgbox'><a href='goodsDetail.html?goodsId="+d[r].goodsId+"'><img class='hoverup' src='img/"+d[r].indexImg+"' /></a></div><p><a href=''>"+d[r].goodsTitle+"</a></p><span class='price'>"+d[r].nowPrice+"</span></li>";s.append(t)}}}}})}})});